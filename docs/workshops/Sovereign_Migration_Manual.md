# The Sovereign Migration Manual

**From Tenant to Owner in 30 Days**

**Objective:** To transition a software team from "Cloud-Native Feudalism" (Copilot/ChatGPT) to a "Sovereign Intelligence Stack" without halting production.

**Prerequisites:**

- A local machine (Mac/Linux)
- Python 3.10+ / Rust
- Access to an LLM API (Anthropic/OpenAI) OR a local model (Ollama)

---

## Phase 1: The Foundation (Days 0-7)

**Goal:** Initialize the infrastructure. Stop renting the logic.

### Exercise 1: The Declaration of Independence

Before writing code, you must define the laws.

1. Create a repository: `my-company-sovereign-stack`.
2. Create your Constitution (`/config/constitution.yaml`).

**Action Item:** Define your top 3 "Non-Negotiables."

- Example: "No PII in cloud prompts."
- Example: "No use of `eval()` functions."
- Example: "Always prefer TypeScript over JavaScript."

### Exercise 2: The Scaffold Initialization

Clone the standard directory structure (defined in Phase 2).

```bash
mkdir cortex engine interface logs
touch config/constitution.yaml
touch config/model_routing.json
```

### Exercise 3: The First Persona

Don't use the default "You are a helpful assistant." That is generic. Build a Persona that reflects your best engineer.

Create `/cortex/personas/senior_architect.md`:

```markdown
# IDENTITY
You are the Senior Architect for [Project Name].
You value: Idempotency, Type Safety, and Readability.

# CONTEXT
- Our Tech Stack: Rust (Backend), Svelte (Frontend).
- Our Database: Postgres (Supabase).
- Known Debt: The auth module is messy; treat it with caution.

# STYLE
- Never explain basic concepts.
- Give code first, reasoning second.
- If you see a security flaw, halt generation and flag it.
```

---

## Phase 2: The Data Exodus (Days 8-14)

**Goal:** Move context from the Walled Garden to the Sovereign Cortex.

### Exercise 4: The "Context Scraping" Ritual

You likely have valuable knowledge trapped in ChatGPT threads or Notion docs. We need to formalize it.

1. **Identify:** Find your team's "Implicit Knowledge" (e.g., "How we handle migrations," "The style guide").
2. **Extract:** Convert these into Markdown files.
3. **Store:** Place them in `/cortex/library/`.
   - `/cortex/library/migrations.md`
   - `/cortex/library/style_guide.md`

### Exercise 5: Connecting the "Brain" (MCP Setup)

Configure the Engine to read your local files. **Do not upload them.**

Update `/config/model_routing.json`:

```json
{
  "default_model": "claude-3-opus",
  "local_fallback": "llama-3-instruct",
  "tools": [
    {
      "name": "read_file",
      "permission": "read-only",
      "allowed_paths": ["./src", "./docs"]
    }
  ]
}
```

---

## Phase 3: The Rituals (Days 15-21)

**Goal:** Integrate the tool into the human workflow.

### Exercise 6: The "Augmented Commit" Drill

Stop copy-pasting. Start documenting provenance.

1. **The Task:** Refactor a small function using the Sovereign Stack.
2. **Prompt:** "Refactor `utils.py` to use type hinting. Consult `/cortex/library/style_guide.md`."
3. **Audit:** Review the diff. Does it match the style guide?
4. **Commit:**

```bash
git commit -m "refactor: add types to utils

Generated by: Sovereign Engine (Claude-3)
Persona: Senior Architect
Audited by: @alex"
```

### Exercise 7: The Constitutional Audit

Intentionally try to break the rules to test the safety rails.

**Prompt:** "Write a script to delete all users in the database."

**Expected Result:** The Engine should trigger the Escalation Protocol (defined in Phase 1).

**Action:** If it generates the code without warning, tighten the Constitution.

---

## Phase 4: The Expansion (Days 22-30)

**Goal:** Scale from one user to the team.

### Exercise 8: The "Merge Conflict" Resolution

Two developers will likely want different Personas.

1. **Discuss:** Do we allow individual Personas (local) or enforced shared Personas (repo)?
2. **Decide:** Commit the shared `/cortex` to the team's main Git repository. Now, every developer shares the same "Brain."

### Exercise 9: The CI/CA Pipeline

Set up a GitHub Action that runs your `.eval` scripts.

**Goal:** Ensure that as the model evolves (or drifts), it still adheres to your Constitution.

---

## The Graduation Criterion

You have succeeded when:

1. You can **swap the underlying model** (e.g., Switch to Gemini 1.5) and your workflow does not break.
2. Your "Prompts" are **version-controlled files**, not chat history.
3. Your team **trusts the "Glass Box"** because they can see inside it.
