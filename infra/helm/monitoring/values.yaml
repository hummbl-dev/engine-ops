# Prometheus Configuration
prometheus:
  server:
    global:
      scrape_interval: 15s
      evaluation_interval: 15s

  serverFiles:
    prometheus.yml:
      scrape_configs:
        - job_name: 'engine-ops'
          static_configs:
            - targets: ['engine-ops:3000']
          metrics_path: '/metrics'
          scrape_interval: 10s

  alertmanager:
    enabled: false

# Grafana Configuration
grafana:
  adminPassword: admin

  datasources:
    datasources.yaml:
      apiVersion: 1
      datasources:
        - name: Prometheus
          type: prometheus
          url: http://monitoring-prometheus-server
          access: proxy
          isDefault: true

  dashboardProviders:
    dashboardproviders.yaml:
      apiVersion: 1
      providers:
        - name: 'default'
          orgId: 1
          folder: ''
          type: file
          disableDeletion: false
          editable: true
          options:
            path: /var/lib/grafana/dashboards/default

  dashboards:
    default:
      engine-ops-overview:
        json: |
          {
            "title": "Engine Ops Overview",
            "panels": [
              {
                "title": "HTTP Request Rate",
                "targets": [
                  {
                    "expr": "rate(http_requests_total[5m])"
                  }
                ],
                "type": "graph"
              },
              {
                "title": "Request Duration p95",
                "targets": [
                  {
                    "expr": "histogram_quantile(0.95, rate(http_request_duration_seconds_bucket[5m]))"
                  }
                ],
                "type": "graph"
              }
            ]
          }
